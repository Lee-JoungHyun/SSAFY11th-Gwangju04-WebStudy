# 4. 설계 품질과 트레이드오프

### 가장 중요한 것은 ‘책임’이다

- 객체들이 수행할 책임이 적절하게 할당되지 못한 상황에서는 원활한 협력도 기대할 수 없을 것이다.
- 역할은 책임의 집합이기 때문에 책임이 적절하지 못하면 역할 역시 협력과 조화를 이루지 못한다.
- 책임은 객체지향 애플리케이션 전체의 품질을 결정하는 중요한 요소이다.

> 객체지향 설계란 올바른 객체에게 **올바른 책임**을 할당하면서 **낮은 결합도**와 **높은 응집도**를 가진 구조를 창조하는 활동이다.
> 

### 훌륭한 객체지향 설계는 책임에 초점을 맞춰야 한다

- 시스템을 분할하기 위해서는 데이터보다는 책임에 초점을 맞춰야 한다.
- 객체의 상태(데이터)는 **구현**에 속한다. 구현은 불안정하기 때문에 변하기 쉽다. 상태를 객체 분할의 중심축으로 삼으면 구현에 관한 세부사항이 객체의 인터페이스에 스며들게 되어 캡슐화의 원칙이 무너진다.
- 객체의 책임은 **인터페이스**에 속한다. 객체는 책임을 드러내는 안정적인 인터페이스 뒤로 책임을 수행하는 데 필요한 상태를 캡슐화함으로써 구현 변경에 대한 파장이 외부로 퍼져나가는 것을 방지한다.

### 좋은 설계인지 판단하는 3가지 기준

- 캡슐화
- 응집도
- 결합도

### 캡슐화

- 외부에서 알 필요가 없는 부분을 감춤으로써 대상을 단순화하는 추상화의 한 종류이다.
- 변경 가능성이 높은 **구현** 부분을 내부에 숨기고, 상대적으로 안정적인 **인터페이스** 부분만 외부에 공개함으로써 변경의 여파를 통제한다.

> 만약 시스템이 완전히 캡슐화된다면 우리는 변경으로부터 완전히 자유로워질 것이다. 만약 시스템의 캡슐화가 크게 부족하다면 우리는 변경으로부터 자유로울 수 없고, 결과적으로 시스템은 진화할 수 없을 것이다. 응집도, 결합도, 중복 역시 훌륭한 코드를 규정하는 데 핵심적인 품질인 것이 사실이지만 캡슐화는 우리를 좋은 코드로 안내하기 때문에 가장 중요한 제1원리이다.
> 

### 응집도

- 모듈에 포함된 내부 요소들이 연관되어 있는 정도를 나타낸다.
- 객체지향의 관점에서 응집도는 객체 또는 클래스에 얼마나 관련 높은 책임들을 할당했는지를 나타낸다.
- 응집도는 **변경이 발생할 때 모듈 내부에서 발생하는 변경의 정도**로 측정할 수 있다. 하나의 변경을 수용하기 위해 모듈 전체가 함께 변경된다면 응집도가 높은 것이고, 모듈의 일부만 변경된다면 응집도가 낮은 것이다.
- 응집도가 높을수록 변경의 대상과 범위가 명확해지기 때문에 코드를 변경하기 쉬워진다.

### 결합도

- 의존성의 정도를 나타내며 다른 모듈에 대해 얼마나 많은 지식을 갖고 있는지를 나타내는 척도이다.
- 객체지향의 관점에서 결합도는 객체 또는 클래스가 협력에 필요한 적절한 수준의 관계만을 유지하고 있는지를 나타낸다.
- 결합도는 **한 모듈이 변경되기 위해서 다른 모듈의 변경을 요구하는 정도**로 측정할 수 있다. 하나의 모듈을 수정할 때 얼마나 많은 모듈을 함께 수정해야 하는지를 나타낸다.
- 영향을 받는 모듈의 수 외에도 변경의 원인을 이용해 결합도의 개념을 설명할 수도 있다.
    - **내부** **구현**을 변경했을 때 이것이 다른 모듈에 영향을 미치는 경우에는 두 모듈 사이의 결합도가 높다고 표현한다.
    - **퍼블릭 인터페이스**를 수정했을 때만 다른 모듈에 영향을 미치는 경우에는 결합도가 낮다고 표현한다.

> 인터페이스에 대해 프로그래밍하라. (**Dependency Inversion Principle**)
> 

### 캡슐화의 정도가 응집도와 결합도에 영향을 미친다

- 캡슐화를 지키면 모듈 안의 응집도는 높아지고 모듈 사이의 결합도는 낮아진다.
- 따라서 응집도와 결합도를 고려하기 전에 먼저 캡슐화를 향상시키기 위해 노력해야 한다.

### 캡슐화의 진정한 의미

- 캡슐화는 단순히 객체 내부의 데이터를 외부로부터 감추는 것 이상의 의미를 가진다.
- 캡슐화란 변할 수 있는 어떤 것이라도 감추는 것이다. 설계에서 변하는 것이 무엇인지 고려하고 변하는 개념을 캡슐화해야 한다.

### 정리

- 유연한 설계를 창조하기 위해서는 **캡슐화**를 설계의 첫 번째 목표로 삼아야 한다.
- 협력이라는 문맥 안에서 필요한 책임을 결정하고 이를 수행할 적절한 객체를 찾는 순서를 잘 지켜야만 올바른 캡슐화를 할 수 있다.